var config_description={height:200};var config_content={toolbar:'Full',height:250};function LoadCKEDITOR(instanceName,fullEditor){if(fullEditor)CKEDITOR.replace(instanceName,config_content);else
CKEDITOR.replace(instanceName,config_description);}function LoadCKEDITORStand(instanceName){CKEDITOR.replace(instanceName,config_stand);}function updateEditor(){for(var name in CKEDITOR.instances)CKEDITOR.instances[name].updateElement();}function createCKFider(instance,imageWidth){$("#"+instance+"Button").click(function(){var finder=new CKFinder();finder.selectActionFunction=function(fileUrl){var htmlRespoint="<input type=\"hidden\" name=\""+instance+"\" value=\""+fileUrl+"\" />";htmlRespoint+="<img src=\""+fileUrl+"\" style=\"border:1px solid #ccc; width:"+imageWidth+"px; margin-top:2px;\" />";$("#"+instance+"Values").html(htmlRespoint);};finder.popup();});}function initAjaxLoad(urlListsLoad,container,callback){$.address.unbind().externalChange(function(event){var urlTransform=urlListsLoad;var urlHistory=event.value;if(urlHistory.length>0){urlHistory=urlHistory.substring(1,urlHistory.length);if(urlTransform.indexOf('?')>0)urlTransform=urlTransform+'&'+urlHistory;else
urlTransform=urlTransform+'?'+urlHistory;}$(container).html("Đang tải dữ liệu...");$.post(urlTransform,function(data){$(container).html(data);}).complete(function(){if(callback&&typeof(callback)==="function"){callback();}});});};function getValueFormMutilSelect(form){var arrParam='';var idMselect;$(form).find("input,textarea,hidden,select").not("input[type='checkbox'], input[type='radio']:checked, input[name='selectItem'], .ms-search input, .mutil").each(function(){idMselect=$(this).attr("name");if($(this).val()!=''&&$(this).val()!='Từ khóa tìm kiếm')arrParam+="&"+idMselect+"="+$(this).val();});$("[data-id='SearchIn'].multiSelectSearch").each(function(){idMselect=$(this).attr("data-id");if(getValueMutilSelect(idMselect)!='')arrParam+="&"+idMselect+"="+getValueMutilSelect(idMselect);});if(arrParam!='')arrParam=arrParam.substring(1);return arrParam;}function regDataTbl(selector){arrOrder=[];arrPrice=[];function paging(){var p=this.page.info();window.history.pushState({},"",getURLPathParameter().changeParam("Page",p.page+1).changeParam("RowPerPage",p.length));};function sorting(){var o=this.order();window.history.pushState({},"",getURLPathParameter().changeParam("OrderBy",o[0][0]).changeParam("Ranked",o[0][1]));}var page=window.location.href.getParamFromUrl("Page");var rowPerPage=window.location.href.getParamFromUrl("RowPerPage");var sort=window.location.href.getParamFromUrl("OrderBy");var keywords=window.location.href.getParamFromUrl("SearchBy");var ranked=window.location.href.getParamFromUrl("Ranked")?window.location.href.getParamFromUrl("Ranked"):"asc";var colCount=0;$(selector+' tr:nth-child(1) td').each(function(){if($(this).attr('colspan')){colCount+=+$(this).attr('colspan');}else{colCount++;}});var arrColumms=[];for(var k=0,j=-1;k<colCount;k++){if(j>=-4){arrColumms.push(j);j--;}else{break;}}var dataTbl=$(selector).DataTable({"iDisplayLength":20,"aLengthMenu":[[20,30,40,50,-1],[20,30,40,50,"All"]],"aoColumnDefs":[{"bSortable":false,"aTargets":arrColumms}],"aaSorting":[]});if(page){page=!isNaN(page)&&parseInt(page)>0?parseInt(page):1;rowPerPage=isNaN(rowPerPage)&&parseInt(rowPerPage)<20?20:parseInt(rowPerPage);var i=dataTbl.page.info();var maxPage=Math.floor(i.recordsTotal/rowPerPage)===i.recordsTotal/rowPerPage?i.recordsTotal/rowPerPage:Math.floor(i.recordsTotal/rowPerPage)+1;page=maxPage>=page?page:maxPage;dataTbl.page(parseInt(page)-1).draw(false);window.history.pushState({},"",getURLPathParameter().changeParam("Page",page));}if(sort){dataTbl.order([parseInt(sort),ranked]).draw(false);}if(rowPerPage&&!isNaN(rowPerPage)){dataTbl.page.len(parseInt(rowPerPage)).draw(false);}if(keywords){dataTbl.search(keywords).draw(false);}$("body").on("change","select[name='tblContent_length']",function(){window.history.pushState({},"",getURLPathParameter().changeParam("RowPerPage",$(this).val()));});$("body").on("keyup","input[type='search']",function(){window.history.pushState({},"",getURLPathParameter().changeParam("SearchBy",$(this).val()));});dataTbl.on("page.dt",paging.bind(dataTbl));dataTbl.on("order.dt",sorting.bind(dataTbl));};function confirmAlert(actionString,action,urlPost,arrRowId,rowTitle){if(!arrRowId){Lobibox.alert("error",{msg:"Bạn chưa chọn bản ghi nào",callback:function($this,type){if(type==='ok'){return;}}});return;}var confirmModal=$('<div class="modal fade in" style="display:none">'+'<div class="modal-dialog modal-lg">'+'<div class="modal-content">'+'<div class="modal-body">'+'<p>Bạn có chắc chắn muốn '+actionString+':<br/></p>'+'<p>'+rowTitle+'</p>'+'</div>'+'<div class="modal-footer">'+'<a href="#" id="okButton" class="btn btn-primary" data-dismiss="modal">Tiếp tục</a>'+'<a href="#" id="cancelButton" class="btn btn-danger">Hủy</a>'+'</div>'+'</div>'+'</div>'+'</div>');confirmModal.find('#okButton').click(function(e){e.preventDefault();$.post(encodeURI(urlPost),{"ActionView":action,"itemId":""+arrRowId+""},function(data){if(data.Erros){noty({text:data.Message,type:'error',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}else{noty({text:data.Message,type:'success',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200},callback:{afterClose:function(){window.location.reload();}},});}});setTimeout(function(){confirmModal.remove();},500);confirmModal.modal('hide');});confirmModal.find('#cancelButton').click(function(e){e.preventDefault();setTimeout(function(){confirmModal.remove();},500);confirmModal.modal('hide');});confirmModal.modal('show');};function doActionForm(formId,modal){var form=formId.serialize();var url=formId.attr("action");$.post(url,form,function(res){if(!res.Erros){if(modal!=''){$(modal).remodal().close();}noty({text:res.Message,type:'success',theme:'metroui',layout:'topRight',timeout:1000,progressBar:true,killer:true,callback:{onClose:function(){window.location.reload();}},animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}else{noty({text:res.Message,type:'error',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}},"json");}function previewFiles(){var preview=document.querySelector('#preview');var files=document.querySelector('input[type=file]').files;function readAndPreview(file){if(/\.(jpe?g|png|gif)$/i.test(file.name)){var reader=new FileReader();reader.addEventListener("load",function(){$("#preview").empty();var image=new Image();image.height=100;image.title=file.name;image.src=this.result;preview.appendChild(image);},false);reader.readAsDataURL(file);}}if(files){[].forEach.call(files,readAndPreview);}}$(function(){$(".hiddenView").click(function(e){e.preventDefault();var arrRowId=$(this).attr("ref");var actionTitle=$(this).attr("actionTitle");var rowTitle=$(this).attr("title");if(actionTitle==''){actionTitle='Ẩn';}confirmAlert(actionTitle,"Hide",urlAlertAction,arrRowId,rowTitle);});$(".showView").click(function(e){e.preventDefault();var arrRowId=$(this).attr("ref");var actionTitle=$(this).attr("actionTitle");var rowTitle=$(this).attr("title");if(actionTitle==''){actionTitle='Hiển thị';}confirmAlert(actionTitle,"Show",urlAlertAction,arrRowId,rowTitle);});$(".deleteView").click(function(e){e.preventDefault();var arrRowId=$(this).attr("ref");var actionTitle=$(this).attr("actionTitle");var rowTitle=$(this).attr("title");if(actionTitle==''){actionTitle='Xóa';}confirmAlert(actionTitle,"Delete",urlAlertAction,arrRowId,rowTitle);});});function profileMember(){$("#formFrofile").validate({rules:{fullName:{required:true},mobile:{required:true},},messages:{fullName:{required:"Họ tên bắt buộc nhập."},mobile:{required:"Điện thoại bắt buộc nhập."}},submitHandler:function(){doActionForm($("#formFrofile"),"#profileId");return false;}});}function doActionFormLogin(formId,modal){var form=formId.serialize();var url=formId.attr("action");}function ForgotPasswordForm(){$("#formForgotPassword").validate({rules:{username:{required:true,},},messages:{username:{required:"Email bắt buộc nhập.",},},submitHandler:function(){doActionForm($("#formForgotPassword"),'');}});}function LoginModelForm(){$("#formLoginModel").validate({rules:{username:{required:true,},password:{required:true,minlength:6,maxlength:20}},messages:{username:{required:"Email bắt buộc nhập.",},password:{required:"Mật khẩu bắt buộc nhập.",minlength:"Mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự."}},submitHandler:function(){doActionForm($("#formLoginModel"),"#loginClose");}});}function RegisterModelForm(){$("#formRegModel").validate({rules:{fullName:{required:true},email:{required:true,email:true},password:{required:true,minlength:6,maxlength:20},repassword:{required:true,minlength:6,maxlength:20,equalTo:"#passwordModel"}},messages:{fullName:{required:"Họ tên bắt buộc nhập."},email:{required:"Email bắt buộc nhập.",email:"Email không đúng định dạng."},password:{required:"Mật khẩu bắt buộc nhập.",minlength:"Mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự."},repassword:{required:"Nhập lại mật khẩu bắt buộc nhập",minlength:"Nhập lại mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Nhập lại mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự.",equalTo:"Nhập lại mật khẩu không đúng."}},submitHandler:function(){if($('#agreeModel').is(":checked")){doActionForm($("#formRegModel"),"#registerClose");}else{noty({text:"Bạn phải đồng ý với điều khoản sử dụng.",type:'error',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}}});}function ChangePasswordForm(){$("#formChangePassword").validate({rules:{passwordOld:{required:true,},passwordNew:{required:true,minlength:6,maxlength:20},repassword:{required:true,minlength:6,maxlength:20,equalTo:"#passwordNew"}},messages:{passwordOld:{required:"Mật khẩu cũ bắt buộc nhập.",},passwordNew:{required:"Mật khẩu mới bắt buộc nhập.",minlength:"Mật khẩu mới phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Mật khẩu mới phải nhỏ hơn hoặc bằng 20 ký tự."},repassword:{required:"Nhập lại mật khẩu bắt buộc nhập",minlength:"Nhập lại mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Nhập lại mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự.",equalTo:"Nhập lại mật khẩu không đúng."}},submitHandler:function(){doActionForm($("#formChangePassword"),'#changePassword');}});}$('#cart-nav-pill [data-toggle="tab"]').click(function(e){e.preventDefault();e.stopPropagation();});function changeTab(target){var $target=$('a[data-toggle="tab"][href="'+target+'"]');$target.tab('show');}$('#cart-nav-pill [data-toggle="tab"]').on('shown.bs.tab',function(){$(this).parent('li').addClass('pass');$(this).parent('li').prevAll('li').addClass('pass');$(this).parent('li').nextAll('li').removeClass('pass');});function changeCity(idCity,idLoadData){$(idCity).change(function(){var cityId=$(this).val();if(cityId!=''){$.ajax({method:"POST",url:"/Ajax/ModuleHome/District",data:{cityId:cityId}}).done(function(msg){$(idLoadData).removeAttr('disabled');$(idLoadData).html(msg);});}else{$(idLoadData).attr("disabled","disabled");}});}function changeDisrtictDrdl(idDisrtict,idLoadData){$("#form-new-add-not-sign").on("change",idDisrtict,function(){var disrtictId=$(this).val();if(disrtictId!=''){$.ajax({method:"POST",url:"/Ajax/ModuleHome/WardsList",data:{disrtictId:disrtictId}}).done(function(msg){$(idLoadData).removeAttr('disabled');$(idLoadData).html(msg);});}else{$(idLoadData).attr("disabled","disabled");}});}$(document).ready(function(){$("#formReg").validate({rules:{fullName:{required:true},email:{required:true,email:true},password:{required:true,minlength:6,maxlength:20},repassword:{required:true,minlength:6,maxlength:20,equalTo:"#password"},mobile:{required:true,number:true,maxlength:11,minlength:10,}},messages:{fullName:{required:"Họ tên bắt buộc nhập."},email:{required:"Email bắt buộc nhập.",email:"Email không đúng định dạng."},password:{required:"Mật khẩu bắt buộc nhập.",minlength:"Mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự."},repassword:{required:"Nhập lại mật khẩu bắt buộc nhập",minlength:"Nhập lại mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Nhập lại mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự.",equalTo:"Nhập lại mật khẩu không đúng."},mobile:{required:"Điện thoại bắt buộc nhập.",number:"Điện thoại phải là kiểu số",maxlength:"Điện thoại phải là 10 hoặc 11 chữ số.",minlength:"Điện thoại phải là 10 hoặc 11 chữ số."}},submitHandler:function(){if($('#agree').is(":checked")){doActionForm($("#formReg"),'');}else{noty({text:"Bạn phải đồng ý với điều khoản sử dụng.",type:'error',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}}});$("#formLogin").validate({rules:{username:{required:true,},password:{required:true,minlength:6,maxlength:20}},messages:{username:{required:"Email bắt buộc nhập.",},password:{required:"Mật khẩu bắt buộc nhập.",minlength:"Mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự."}},submitHandler:function(){doActionForm($("#formLogin"),'');}});changeCity("#city","#district");});changeCity("#city-order","#district-order");$("#formLoginOrder").validate({rules:{username:{required:true,},password:{required:true,minlength:6,maxlength:20}},messages:{username:{required:"Email bắt buộc nhập.",},password:{required:"Mật khẩu bắt buộc nhập.",minlength:"Mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự."}},submitHandler:function(){doActionForm($("#formLoginOrder"),'');}});changeCity("#payment_city","#payment_disrtict");$("#formRegOrder").validate({rules:{fullName:{required:true},email:{required:true,email:true},password:{required:true,minlength:6,maxlength:20},repassword:{required:true,minlength:6,maxlength:20,equalTo:"#password"},mobile:{required:true,number:true,maxlength:11,minlength:10,}},messages:{fullName:{required:"Họ tên bắt buộc nhập."},email:{required:"Email bắt buộc nhập.",email:"Email không đúng định dạng."},password:{required:"Mật khẩu bắt buộc nhập.",minlength:"Mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự."},repassword:{required:"Nhập lại mật khẩu bắt buộc nhập",minlength:"Nhập lại mật khẩu phải lớn hơn hoặc bằng 6 ký tự.",maxlength:"Nhập lại mật khẩu phải nhỏ hơn hoặc bằng 20 ký tự.",equalTo:"Nhập lại mật khẩu không đúng."},mobile:{required:"Điện thoại bắt buộc nhập.",number:"Điện thoại phải là kiểu số",maxlength:"Điện thoại phải là 10 hoặc 11 chữ số.",minlength:"Điện thoại phải là 10 hoặc 11 chữ số."}},submitHandler:function(){if($('#agree').is(":checked")){doActionForm($("#formRegOrder"),'');}else{noty({text:"Bạn phải đồng ý với điều khoản sử dụng.",type:'error',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}}});$("#form-new-add-not-sign-btn").click(function(){$("#form-new-add-not-sign").validate({rules:{paymentfullname:{required:true,},paymentadd:{required:true,},paymentmobile:{required:true,minlength:6,maxlength:20,number:true},},messages:{paymentfullname:{required:"Bắt buộc nhập.",},paymentadd:{required:"Bắt buộc nhập.",},paymentmobile:{required:"Bắt buộc nhập.",minlength:"Lớn hơn hoặc bằng 10 chữ số.",maxlength:"Nhỏ hơn hoặc bằng 20 chữ số.",number:"Chỉ được nhập số"},},submitHandler:function(){var fullname=$("#paymentfullname").val();var paymentadd=$("#paymentadd").val();var paymentmobile=$("#paymentmobile").val();var paymentcity=$("#payment_city").val();var paymentdisrtict=$("#payment_disrtict").val();var paymentward=$("#payment_ward").val();$("#paymentfullnamesubmit").val(fullname);$("#payment_addsubmit").val(paymentadd);$("#paymentphonesubmit").val(paymentmobile);$("#payment_citysubmit").val(paymentcity);$("#payment_disrtictsubmit").val(paymentdisrtict);$("#payment_wardsubmit").val(paymentward);$("#menu2").find(".name-not-sign").text(fullname);$("#menu2").find(".add-not-sign").text(paymentadd);$("#menu2").find(".phone-not-sign").text(paymentmobile);changeTab('#menu2');}});});$("input[name='request_person']").change(function(){if($(this).val()==0){$("#request-person-frm").removeClass("hidden");$("#other-person-frm").addClass("hidden");}else{$("#request-person-frm").addClass("hidden");$("#other-person-frm").removeClass("hidden");}});$("input#invoice_check").change(function(){if($(this).is(":checked")){$(".invoice_check_status").removeClass("hidden");}else{$(".invoice_check_status").addClass("hidden");}});$("#btn-send-order").click(function(e){e.preventDefault();var d=$("#form-send-order").serialize();var url=$("#form-send-order").attr("action");$.post(url,d,function(data){if(data.errorcode==1){$.cookie("shopping_cart",null,{path:'/',expires:-5});window.location.href=data.urlreturn;}else{alert(data.errormessage);$("#btn-send-order-1").bind("click",doSendOrder);}},"json");});$("#formEditInforOrder").validate({rules:{fullName:{required:true,},mobile:{required:true,number:true},address:{required:true,}},messages:{fullName:{required:"Bắt buộc nhập.",},mobile:{required:"Bắt buộc nhập.",number:"Chỉ bao gồm số."},address:{required:"Bắt buộc nhập.",},},submitHandler:function(){var form=$("#formEditInforOrder").serialize();var url=$("#formEditInforOrder").attr("action");$.post(url,form,function(res){if(!res.Erros){noty({text:res.Message,type:'success',theme:'metroui',layout:'topRight',timeout:1000,progressBar:true,killer:true,callback:{onClose:function(){window.location.reload();}},animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}else{noty({text:res.Message,type:'error',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}},"json");}});changeCity("#newcity","#newdisrtict");$("#newInfor").validate({rules:{fullName:{required:true,},mobile:{required:true,number:true},address:{required:true,}},messages:{fullName:{required:"Bắt buộc nhập.",},mobile:{required:"Bắt buộc nhập.",number:"Chỉ bao gồm số."},address:{required:"Bắt buộc nhập.",},},submitHandler:function(){var fullname=$("#newFullname").val();var paymentadd=$("#newadd").val();var paymentmobile=$("#newmobile").val();var paymentcity=$("#newcity").val();var paymentdisrtict=$("#newdisrtict").val();var paymentward=$("#newward").val();$("#paymentfullnamesubmit").val(fullname);$("#payment_addsubmit").val(paymentadd);$("#paymentphonesubmit").val(paymentmobile);$("#payment_citysubmit").val(paymentcity);$("#payment_disrtictsubmit").val(paymentdisrtict);$("#payment_wardsubmit").val(paymentward);$("#menu2").find(".name-not-sign").text(fullname);$("#menu2").find(".add-not-sign").text(paymentadd);$("#menu2").find(".phone-not-sign").text(paymentmobile);if($("#defaultnewinfor").is(":checked")){var form=$("#newInfor").serialize();var url=$("#newInfor").attr("action");$.post(url,form,function(res){if(!res.Erros){noty({text:res.Message,type:'success',theme:'metroui',layout:'topRight',timeout:1000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}else{noty({text:res.Message,type:'error',theme:'metroui',layout:'topRight',timeout:3000,progressBar:true,killer:true,animation:{open:'animated fadeIn',close:'animated fadeOut',speed:200}});}},"json");}else{$("#menu2").find(".name-not-sign").text(fullname);$("#menu2").find(".add-not-sign").text(paymentadd);$("#menu2").find(".phone-not-sign").text(paymentmobile);}debugger
setInterval(function(){changeTab('#menu2');},1000);}});